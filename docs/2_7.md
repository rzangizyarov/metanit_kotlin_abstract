# 2.7 Условные конструкции

Условные конструкции позволяют направить выполнение программы по одному из путей в зависимости от условия.

## if...else

Конструкция `if` принимает условие, и если это условие истинно, то выполняется последующий блок инструкций.

```kotlin
val a = 10

if (a == 10) {
    println("a равно 10")
}
```

```commandline
a равно 10
```

В данном случае в конструкции `if` проверяется истинность выражения `a == 10`, если оно истинно, то выполняется последующий блок кода в фигурных скобках, и на консоль выводится сообщение "a равно 10". Если же выражение ложно, тогда блок кода не выполняется.

Если необходимо задать альтернативный вариант, нужно добавить блок `else`:

```kotlin
val a = 10

if (a == 10) {
    println("a равно 10")
}
else{
    println("a НЕ равно 10")
}
```

```commandline
a равно 10
```

Таким образом, если условное выражение после оператора `if` истинно, то выполняется блок после `if`, если ложно - выполняется блок после `else`. 

Если блок кода состоит из одного выражения, то фигурные скобки можно опустить:

```kotlin
val a = 10
if (a == 10)
    println("a равно 10")
else
    println("a НЕ равно 10")
```

```commandline
a равно 10
```

Если необходимо проверить несколько альтернативных вариантов, то можно добавить выражения `else if`:

```kotlin
val a = 10

if (a == 10) {
    println("a равно 10")
}
else if (a == 9){
    println("a равно 9")
}
else if (a == 8) {
    println("a равно 8")
}
else{
    println("a имеет неопределенное значение")
}
```

```commandline
a равно 10
```

## Использование if для возвращения значения

Стоит отметить, что в языке Kotlin `if` может возвращать значение. Например, найдем максимальное из двух чисел:

```kotlin
val a = 10
val b = 20
val c = if (a > b) a else b  // Тернарный оператор в Kotlin

println(c)  // 20
```

```commandline
20
```

Если при определении возвращаемого значения надо выполнить еще какие-нибудь действия, то можно заключить эти действия в блоки кода:

```kotlin
val a = 10
val b = 20
val c = if (a > b) {
    println("a = $a")
    a
} else {                    // Ключевые слова else, catch, finally, while 
    println("b = $b")       // помещаются на ту же строку, что и предыдущая фигурная скобка.
    b
}
```

```commandline
b = 20
```

В конце каждого блока указывается возвращаемое значение.

Когда вы используете `if` как выражение, ОБЯЗАТЕЛЬНО включайте секцию `else`.


## Конструкция when

Конструкция `when` проверяет значение некоторого объекта и в зависимости
от него выполняет тот или иной код. Конструкция `when` аналогична
конструкции `switch` в других языках. Формальное определение:

```kotlin
when(объект){ 
    значение1 -> действия1
    значение2 -> действия2
    ...
    значениеN -> действияN
}
```

Если значение объекта равно одному из значений в блоке кода `when`, то
выполняются соответствующие действия, которые идут после оператора `->`
после соответствующего значения.

Например:

```kotlin
fun main() {
    val isEnabled = true
    when (isEnabled) {
        false -> println("isEnabled off")
        true -> println("isEnabled on")
    }
}

main()
```

```commandline
isEnabled on
```

Здесь в качестве объекта в конструкцию `when` передается переменная
`isEnabled`. Далее ее значение по порядку сравнивается со значениями в
`false` и `true`. В данном случае переменная `isEnabled` равна `true`,
поэтому будет выполняться код

```kotlin
println("isEnabled on")
```

```commandline
isEnabled on
```

### Выражение else

В примере выше переменная `isEnabled` имела только два возможных варианта:
`true` и `false`. Однако чаще бывают случаи, когда значения в блоке `when`
не покрывают все возможные значения объекта. Дополнительное выражение
`else` позволяет задать действия, которые
выполняются, если объект не соответствует ни одному из значений.
Например:

```kotlin
val a = 30
when (a) {
    10 -> println("a = 10")
    20 -> println("a = 20")
    else -> println("неопределенное значение")
}
```

```commandline
неопределенное значение
```

То есть в данном случае если переменная `a` равна 30, поэтому она не
соответствует ни одному из значений в блоке `when`. И соответственно будут
выполняться инструкции из выражения `else`.

Если надо, чтобы при совпадении значений выполнялось несколько
инструкций, то для каждого значения можно определить блок кода:

```kotlin
var a = 10
when (a) {
    10 -> {
        println("a = 10")
        a *= 2
    }
    20 -> {
        println("a = 20")
        a *= 5
    }
    else -> { println("неопределенное значение") }
}
println(a)
```

```commandline
a = 10
20
```

### Сравнение с набором значений

Можно определить одни и те же действия сразу для нескольких значений. В
этом случае значения перечисляются через запятую:

```kotlin
val a = 10
when (a) {
    10, 20 -> println("a = 10 или a = 20")
    else -> println("неопределенное значение")
}
```

```commandline
a = 10 или a = 20
```

Также можно сравнивать с целым диапазоном значений с помощью оператора
`in`:

```kotlin
val a = 10
when (a) {
    in 10..19 -> println("a в диапазоне от 10 до 19")
    in 20..29 -> println("a в диапазоне от 20 до 29")
    !in 10..20 -> println("a вне диапазона от 10 до 20")
    else -> println("неопределенное значение")
}
```

```commandline
a в диапазоне от 10 до 19
```

Если оператор `in` позволяет узнать, есть ли
значение в определенном диапазоне, то связка операторов `!in` позволяет проверить отсутствие значения в
определенной последовательности.

### when и динамически вычисляемые значения

Выражение в when также может сравниваться с динамически вычисляемыми
значениями:

```kotlin
fun main() {

    val a = 10
    val b = 5
    val c = 3
    when (a) {
        b - c -> println("a = b - c")
        b + 5 -> println("a = b + 5")
        else -> println("неопределенное значение")
    }
}
```

Так, в данном случае значение переменной `a` сравнивается с результатом
операций `b - c` и `b + 5`.

Кроме того, `when` также может может принимать динамически вычисляемый
объект:

```kotlin
fun main() {
    val a = 10
    val b = 20
    when (a + b) {
        10 -> println("a + b = 10")
        20 -> println("a + b = 20")
        30 -> println("a + b = 30")
        else -> println("Undefined")
    }
}
```

Можно даже определять переменные, которые будут доступны внутри блока
`when`:

```kotlin
fun main() {
    val a = 10
    val b = 26
    when (val c = a + b) {
        10 -> println("a + b = 10")
        20 -> println("a + b = 20")
        else -> println("c = $c")
    }
}
```

### when как альтернатива для if..else

Причем в принципе нам необязатльно вообще сравнивать значение
какого-либо объекта. Конструкция `when` аналогично конструкции
`if..else` просто может поверять набор условий и если одно из условий
возвращает `true`, то выполнять соответствующий набор действий:

```kotlin
fun main() {
    val a = 15
    val b = 6
    when {
        (b > 10) -> println("b больше 10")
        (a > 10) -> println("a больше 10")
        else -> println("и a, и b меньше или равны 10")
    }
}
```

### Использование when для возвращения значений

Как и `if` конструкция `when` может возвращать значение. Возвращаемое
значение указывается после оператора `->`:

```kotlin
val sum = 1000

val rate = when (sum) {
    in 100..999 -> 10
    in 1000..9999 -> 15
    else -> 20
}
println(rate)       // 15
```

```commandline
15
```

Таким образом, если значение переменной sum располагается в определенном
диапазоне, то возвращается то значение, которое идет после стрелки.


## Резюме

```kotlin
fun main() {
    val x = 2000

    if (x > 10) {
        println("kek")
    } else {
        println("not kek")
    }

    if (x > 10) {
        println("kek")
    } else if (x > 5) {
        println("almost kek")
    } else {
        println("not kek")
    }

    // Если блок кода состоит из одного выражения
    if (x > 10)
        println("kek")
    else
        println("not kek")

    // Можно записать в одну строку
    if (x > 10) println("kek") else println("not kek")

    // if может возвращать значение (обязательно использовать else)
    // Тернарный оператор в Kotlin:
    val isXBiggerThanTen = if (x > 10) true else false

    // Перед возвратом значения из if можно выполнять действия
    val isXBiggerThanTen2 = if (x > 10) {
        println("x больше 10")
        true
    } else {
        println("x меньше 10")
        false
    }

    // Инструкция when
    var a = 10
    when (a) {
        10 -> println("a = 10")
        20, 30 -> println("a = 20 или a = 30")
        40 -> {
            println("a = 40, но щас исправим")
            a -= 10
        }
        in 50..100 -> println("a в диапазоне от 50 до 100")
        else -> println("значение неопределено")
    }

    // Инструкция when как альтернатива для if..else
    when {
        (a < 10) -> println("a больше 10")
        else -> println("a меньше или равно 10")
    }

    // when может возвращать значение (также обязательно использовать else)
    val r = when (a) {
        in 1..100 -> 1
        else -> 0
    }
}
```

